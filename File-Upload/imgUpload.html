<!DOCTYPE html>
<html>
    <head>
        <title>이미지 파일 업로드와 업로드한 파일 미리보기</title>
    </head>
    <body>
        <h1>이미지 파일 업로드 & 업로드한 파일 미리보기</h1>
        <!-- input type을 파일로 타입을 지정한 후
            accept : 허용되는 파일 유형을 이미지로 제한 
            * : jpg, jpeg, png 등 다양한 이미지 파일을 모두 허용하겠다는 의미
            만약 png 파일만 허용하고 싶다면 accept = "image/png" 이런 식으로 사용 가능-->
        <input type="file" id="fileInput" accept="image/*">
        <button id="uploadButton">업로드</button>

        <div id="imageContainer"><!-- 이미지를 표시할 컨테이너 -->
            <img id="uploadImage" style="width: 200px;">
        </div>
        <script>
            // 파일을 업로드하는 버튼 클릭시 이벤트 처리
            document.getElementById("uploadButton").addEventListener("click", function(){
                var fileInput = document.getElementById("fileInput"); // 파일 선택
                var uploadImage = document.getElementById("uploadImage");
                var imageContainer = document.getElementById("imageContainer");

                // 만약 파일이 존재한다면 이미지를 보여주기
                if(fileInput.files.length > 0){
                    var file = fileInput.files[0]; /* 파일 입력 필드에서 선택한 파일 목록에서 첫 번째 파일을 가져온 후, 마치 사용자가
                                                      한 파일만 선택한 것이라고 판단하게 함.*/
                    var reader = new FileReader();// 현재는 빈 값. 빈 값인 파일을 읽기 위한 FileReader() 객체를 생성한 것 뿐
                    // FileReader에는 onload라는 메서드가 존재한다. on이라고 시작하는 것들은 모두 event (ex. onClick, onSubmit 등)
                    // 파일 읽기가 완료될 때 호출 된다.
                    reader.onload = function (e) { /* e는 event의 e임. e.target & e.value는 많이 사용되는 문법
                        onload는 위에 있는 fileReader로 읽은 녀석이 준비가 되었다는 의미*/

                        // uploadImage.src : 이미지 주소를 추가
                        // e.target.result : FileReader가 읽은 파일의 데이터 URL을 나타냄
                        uploadImage.src = e.target.result; // 이미지 컨테이너에 스타일을 적용해서 업로드 된 이미지 표시 // 타겟이 된 파일을 주소 안으로 넣는 것

                        
                        imageContainer.style.display = "block"; // 이미지를 보여줌
                    };
                    /*
                    FileReader 사용해서 선택한 file을 DataURL로 읽은 후 문자열로 표현하여 표시하는 것
                    */
                    reader.readAsDataURL(file); // 파일을 Data URL로 읽는 것
                }
            })
        </script>
    </body>
</html>